{
    "collab_server" : "",
    "contents" : "library(ggplot2)\nlibrary(gridExtra)\nlibrary(reshape)\nlibrary(lubridate)\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(stringr)\n\nm46 = read.csv(\"m46labelled.csv\")\nm60 = read.csv(\"m60labelled.csv\")\n\n\nm46$type = factor(m46$type)\n\nm46$StartTime <- as.POSIXct(m46$StartTime, format = \"%d/%m/%Y %H:%M\")\n\nm60$type = factor(m60$type)\nm60$StartTime <- as.POSIXct(m60$StartTime, format = \"%Y-%m-%d %H:%M:%S\")\n\nmonthname = \"Apr\"\n\nm46 = m46[which(month.abb[month(m46$StartTime)]==monthname),]\nm60 = m60[which(month.abb[month(m60$StartTime)]==monthname),]\n\n\nm46typecount = data.frame(t(summary(m46$type)))\nm60typecount = data.frame(t(summary(m60$type)))\nnames(m46typecount)=c(0,1,100,101,111,1001,1100,1101,1111)\nnames(m60typecount)=c(0,1,100,101,111,1001,1100,1101,1111)\n\nm46summary=tapply(m46$THD1,m46$type,mean)\nm46summary=rbind(m46summary,tapply(m46$THD2,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$THD3,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H1_1,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H2_1,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H3_1,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H5_1,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H7_1,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H1_2,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H2_2,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H3_2,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H5_2,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H7_2,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H1_3,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H2_3,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H3_3,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H5_3,m46$type,mean))\nm46summary=rbind(m46summary,tapply(m46$H7_3,m46$type,mean))\n\nm60summary=tapply(m60$THD1,m60$type,mean)\nm60summary=rbind(m60summary,tapply(m60$THD2,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$THD3,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H1_1,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H2_1,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H3_1,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H5_1,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H7_1,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H1_2,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H2_2,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H3_2,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H5_2,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H7_2,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H1_3,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H2_3,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H3_3,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H5_3,m60$type,mean))\nm60summary=rbind(m60summary,tapply(m60$H7_3,m60$type,mean))\n\ntablenames = c('THD1','THD2','THD3','H1_1','H2_1','H3_1','H5_1','H7_1','H1_2','H2_2','H3_2','H5_2','H7_2',\n               'H1_3','H2_3','H3_3','H5_3','H7_3')\nrownames(m46summary) = tablenames\nrownames(m60summary) = tablenames\n\nm46rawmean = as.matrix(m46summary) %*% t(as.matrix(m46typecount))\nm60rawmean = as.matrix(m60summary) %*% t(as.matrix(m60typecount))\n\n\n#df3 <- m46[,c('THD1','THD2','THD3','H1_1','H2_1','H3_1','H5_1','H7_1','H1_2','H2_2','H3_2','H5_2','H7_2',\n#              'H1_3','H2_3','H3_3','H5_3','H7_3', 'type')]\n#df3 <- melt(df3, id=c(\"type\"))\n\ndf3=m46[,c('THD1','type')]\ndf3$type=str_pad(df3$type, 4, pad = \"0\")\n\ndf3count = data.frame(t(m46typecount)/sum(m46typecount))\ncolnames(df3count) = c(\"count\")\ndf3count$x=c(0,1,100,101,111,1001,1100,1101,1111)\ndf3count$x=str_pad(df3count$x, 4, pad = \"0\")\n\nmeans <- aggregate(THD1 ~  type, df3, mean)\nmeans$THD1 = round(means$THD1,3)\n\njpeg(paste0(monthname,' (m46).jpg'))\n\nggplot() + \n  geom_boxplot(data = df3,aes(x=type, y = THD1, fill = type)) + \n  stat_summary(data = df3,aes(x=type, y = THD1),fun.y=mean, colour=\"darkred\", geom=\"point\", \n               shape=18, size=4,show_guide = FALSE) + \n  xlab(\"Filter Combination\") + ylab(\"THD\") + \n  geom_line(group=1,data=df3count, aes(y=count,x=factor(x)),colour=\"red\") + \n  geom_text(data = means, aes(x = factor(type),label = THD1, y = THD1 + 0.12)) +\n  ggtitle(monthname) + theme_bw() + \n#  ylim(0,1.5) + \n  scale_y_continuous(limits = c(0,1.5), expand = c(0, 0)) +\n  theme(panel.border = element_blank(), panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank(), axis.ticks.x=element_blank(), \n        axis.ticks.y=element_blank(), plot.title = element_text(hjust = 0.5), \n        axis.line = element_line(colour = \"black\"))\n\ndev.off()\n\n\ndf4=m60[,c('THD1','type')]\ndf4$type=str_pad(df4$type, 4, pad = \"0\")\n\ndf4count = data.frame(t(m60typecount)/sum(m60typecount))\ncolnames(df4count) = c(\"count\")\ndf4count$x=c(0,1,100,101,111,1001,1100,1101,1111)\ndf4count$x=str_pad(df4count$x, 4, pad = \"0\")\n\nmeans1 <- aggregate(THD1 ~  type, df4, mean)\nmeans1$THD1 = round(means1$THD1,3)\n\njpeg(paste0(monthname,' (m60).jpg'))\n\nggplot() + \n  geom_boxplot(data = df4,aes(x=type, y = THD1, fill = type)) + \n  stat_summary(data = df4,aes(x=type, y = THD1),fun.y=mean, colour=\"darkred\", geom=\"point\", \n               shape=18, size=4,show_guide = FALSE) + \n  xlab(\"Filter Combination\") + ylab(\"THD\") + \n  geom_line(group=1,data=df4count, aes(y=count,x=factor(x)),colour=\"red\") + \n  geom_text(data = means1, aes(x = factor(type),label = THD1, y = THD1 + 0.12)) +\n  ggtitle(monthname) + theme_bw() + \n  #  ylim(0,1.5) + \n  scale_y_continuous(limits = c(0,1.5), expand = c(0, 0)) +\n  theme(panel.border = element_blank(), panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank(), axis.ticks.x=element_blank(), \n        axis.ticks.y=element_blank(), plot.title = element_text(hjust = 0.5), \n        axis.line = element_line(colour = \"black\"))\n\ndev.off()\n\n#2 sample t test\ncombi0101 = df3[which(df3$type=='0101'),'THD1']\ncombi0111 = df3[which(df3$type=='0111'),'THD1']\nt.test(combi0101,combi0111,var.equal = FALSE, paired=FALSE,alternative = 'greater')\n",
    "created" : 1527095510822.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3168264674",
    "id" : "4EAAB431",
    "lastKnownWriteTime" : 1527665157,
    "last_content_update" : -2147483648,
    "path" : "~/Downloads/WI4231 Mathematical Data Science/Each/Monthly Graphs.R",
    "project_path" : "Monthly Graphs.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}