{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Daily THD visualisation with Filter on off\"\noutput: html_notebook\n---\n```{r}\n# Importing libraries and reading data\nlibrary(ggplot2)\nlibrary(gridExtra)\nlibrary(reshape)\nlibrary(lubridate)\nlibrary(zoo)\nlibrary(plyr)\nlibrary(tidyr)\nlibrary(hexbin)\nm46 <- read.csv(\"data/combined/46combined1.csv\")\nm60 <- read.csv(\"data/combined/60combined1.csv\")\n```\n```{r}\n# Transforming date and time variables\nm46$StartTime <- as.POSIXct(m46$StartTime, format = \"%Y-%m-%d %H:%M:%S\")\nm60$StartTime <- as.POSIXct(m60$StartTime, format = \"%Y-%m-%d %H:%M:%S\")\nm46$B11time <- as.POSIXct(m46$B11time, format = \"%Y-%m-%d %H:%M:%S\")\nm60$B11time <- as.POSIXct(m60$B11time, format = \"%Y-%m-%d %H:%M:%S\")\nm46$B12time <- as.POSIXct(m46$B12time, format = \"%Y-%m-%d %H:%M:%S\")\nm60$B12time <- as.POSIXct(m60$B12time, format = \"%Y-%m-%d %H:%M:%S\")\nm46$B21time <- as.POSIXct(m46$B21time, format = \"%Y-%m-%d %H:%M:%S\")\nm60$B21time <- as.POSIXct(m60$B21time, format = \"%Y-%m-%d %H:%M:%S\")\nm46$B22time <- as.POSIXct(m46$B22time, format = \"%Y-%m-%d %H:%M:%S\")\nm60$B22time <- as.POSIXct(m60$B22time, format = \"%Y-%m-%d %H:%M:%S\")\n\n# Combining the dataset\nm46$type <- \"m46\"\nm60$type <- \"m60\"\n\n# Adding time specific columns\nm46$month <- month.abb[month(m46$StartTime)]\nm46$time  <- time(m46$StartTime)\nm46$day   <- day(m46$StartTime)\n\nm60$month <- month.abb[month(m60$StartTime)]\nm60$time  <- time(m60$StartTime)\nm60$day   <- day(m60$StartTime)\n\n# Partitioning data by month\nm46$monthorder <- 0\nm46[m46$month == 'Nov', c('monthorder')] <- seq(1, nrow(m46[m46$month == 'Nov',]), 1)\nm46[m46$month == 'Dec', c('monthorder')] <- seq(1, nrow(m46[m46$month == 'Dec',]), 1)\nm46[m46$month == 'Jan', c('monthorder')] <- seq(1, nrow(m46[m46$month == 'Jan',]), 1)\nm46[m46$month == 'Feb', c('monthorder')] <- seq(1, nrow(m46[m46$month == 'Feb',]), 1)\nm46[m46$month == 'Mar', c('monthorder')] <- seq(1, nrow(m46[m46$month == 'Mar',]), 1)\nm46[m46$month == 'Apr', c('monthorder')] <- seq(1, nrow(m46[m46$month == 'Apr',]), 1)\nm46$month <- factor(m46$month, c(\"Nov\", \"Dec\", \"Jan\", \"Feb\", \"Mar\", \"Apr\")) #Ordering based on months\n\nm60$monthorder <- 0\nm60[m60$month == 'Nov', c('monthorder')] <- seq(1, nrow(m60[m60$month == 'Nov',]), 1)\nm60[m60$month == 'Dec', c('monthorder')] <- seq(1, nrow(m60[m60$month == 'Dec',]), 1)\nm60[m60$month == 'Jan', c('monthorder')] <- seq(1, nrow(m60[m60$month == 'Jan',]), 1)\nm60[m60$month == 'Feb', c('monthorder')] <- seq(1, nrow(m60[m60$month == 'Feb',]), 1)\nm60[m60$month == 'Mar', c('monthorder')] <- seq(1, nrow(m60[m60$month == 'Mar',]), 1)\nm60[m60$month == 'Apr', c('monthorder')] <- seq(1, nrow(m60[m60$month == 'Apr',]), 1)\nm60$month <- factor(m60$month, c(\"Nov\", \"Dec\", \"Jan\", \"Feb\", \"Mar\", \"Apr\")) #Ordering based on months\n\n# Partitioning data by day of the week\nm46$wday <- wday(m46$StartTime, label=TRUE)\nm46$dayorder <- 0\nmonths = c('Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr')\ndays = 1:31\nfor (month in months){\n  for (day in days){\n    if (max(m46[m46$month==month,'day']) < day){\n      next\n    }\n    m46[m46$month == month & m46$day == day, c('dayorder')] <- 1:nrow(m46[m46$month == month & m46$day == day, ])\n  }\n}\n\nm60$wday <- wday(m60$StartTime, label=TRUE)\nm60$dayorder <- 0\nmonths = c('Nov', 'Dec', 'Jan', 'Feb', 'Mar', 'Apr')\ndays = 1:31\nfor (month in months){\n  for (day in days){\n    if (max(m60[m60$month==month,'day']) < day){\n      next\n    }\n    m60[m60$month == month & m60$day == day, c('dayorder')] <- 1:nrow(m60[m60$month == month & m60$day == day, ])\n  }\n}\n\n# Adding week number data\nm46$week <- week(m46$StartTime)\nm60$week <- week(m60$StartTime)\n\n# combining datasets\ndf <- rbind(m46, m60)\n```\n\n```{r}\ndf$readdate <- paste(df$month, df$day)\norder <- unique(df$readdate)\ndf$readdate <- factor(df$readdate, order)\n```\n\n```{r}\ndf$B11dif <- as.numeric(difftime(df$StartTime, df$B11time, units = 'secs'))\ndf$B12dif <- as.numeric(difftime(df$StartTime, df$B12time, units = 'secs'))\ndf$B21dif <- as.numeric(difftime(df$StartTime, df$B21time, units = 'secs'))\ndf$B22dif <- as.numeric(difftime(df$StartTime, df$B22time, units = 'secs'))\n\ndf$B11month <- month.abb[month(df$B11time)]\ndf$B12month <- month.abb[month(df$B12time)]\ndf$B21month <- month.abb[month(df$B21time)]\ndf$B22month <- month.abb[month(df$B22time)]\n\ndf$B11dif=df$B11dif/3600\ndf$B12dif=df$B12dif/3600\ndf$B21dif=df$B21dif/3600\ndf$B22dif=df$B22dif/3600\n```\n\n\n```{r}\nggplot(data=df[df$type=='m46',],aes(x=B11dif,y=B11THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B11) + xlab('Time Elapsed (in hours)') + ggtitle('B11') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD')\nggplot(data=df[df$type=='m46',],aes(x=B12dif,y=B12THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B12) + xlab('Time Elapsed (in hours)') + ggtitle('B12') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD')\nggplot(data=df[df$type=='m46',],aes(x=B21dif,y=B21THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B21) + xlab('Time Elapsed (in hours)') + ggtitle('B21') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD')\nggplot(data=df[df$type=='m46',],aes(x=B22dif,y=B22THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B22) + xlab('Time Elapsed (in hours)') + ggtitle('B22') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD')\n```\n\n```{r}\nggplot(data=df[df$type=='m60',],aes(x=B11dif,y=B11THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B11) + xlab('Time Elapsed (in hours)') + ggtitle('B11') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD')\nggplot(data=df[df$type=='m60',],aes(x=B12dif,y=B12THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B12) + xlab('Time Elapsed (in hours)') + ggtitle('B12') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD')\nggplot(data=df[df$type=='m60',],aes(x=B21dif,y=B21THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B21) + xlab('Time Elapsed (in hours)') + ggtitle('B21') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD')\nggplot(data=df[df$type=='m60',],aes(x=B22dif,y=B22THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B22) + xlab('Time Elapsed (in hours)') + ggtitle('B22') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD')\n```\n\n```{r}\nggplot(data=df[df$type=='m46',],aes(x=B11dif,y=B11THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B11) + xlab('Time Elapsed (in hours)') + ggtitle('B11') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,100)\nggplot(data=df[df$type=='m46',],aes(x=B12dif,y=B12THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B12) + xlab('Time Elapsed (in hours)') + ggtitle('B12') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,100)\nggplot(data=df[df$type=='m46',],aes(x=B21dif,y=B21THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B21) + xlab('Time Elapsed (in hours)') + ggtitle('B21') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,100)\nggplot(data=df[df$type=='m46',],aes(x=B22dif,y=B22THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B22) + xlab('Time Elapsed (in hours)') + ggtitle('B22') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,100)\n```\n\n```{r}\nggplot(data=df[df$type=='m60',],aes(x=B11dif,y=B11THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B11) + xlab('Time Elapsed (in hours)') + ggtitle('B11') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,5)\nggplot(data=df[df$type=='m60',],aes(x=B12dif,y=B12THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B12) + xlab('Time Elapsed (in hours)') + ggtitle('B12') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,5)\nggplot(data=df[df$type=='m60',],aes(x=B21dif,y=B21THD)) + geom_hex(bins=40) + theme_bw() + facet_wrap(~B21) + xlab('Time Elapsed (in hours)') + ggtitle('B21') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,5)\nggplot(data=df[df$type=='m60',],aes(x=B22dif,y=B22THD)) + geom_hex(bins=60) + theme_bw() + facet_wrap(~B22) + xlab('Time Elapsed (in hours)') + ggtitle('B22') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,5)\n```\n\n```{r}\nggplot(data=df[df$type=='m60',],aes(x=B11dif,y=B11THD)) + geom_point(aes(x=B11dif,y=B11THD),color='dodgerblue',alpha=0.3) + theme_bw() + facet_wrap(~B11) + xlab('Time Elapsed (in hours)') + ggtitle('B11') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,5)\nggplot(data=df[df$type=='m60',],aes(x=B12dif,y=B12THD)) + geom_point(aes(x=B21dif,y=B12THD),color='dodgerblue',alpha=0.3) + theme_bw() + facet_wrap(~B12) + xlab('Time Elapsed (in hours)') + ggtitle('B12') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,5)\nggplot(data=df[df$type=='m60',],aes(x=B21dif,y=B21THD)) + geom_point(aes(x=B21dif,y=B21THD),color='dodgerblue',alpha=0.3) + theme_bw() + facet_wrap(~B21) + xlab('Time Elapsed (in hours)') + ggtitle('B21') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,10)\nggplot(data=df[df$type=='m60',],aes(x=B22dif,y=B22THD)) + geom_point(aes(x=B22dif,y=B22THD),color='dodgerblue',alpha=0.3) + theme_bw() + facet_wrap(~B22) + xlab('Time Elapsed (in hours)') + ggtitle('B22') + theme(plot.title = element_text(hjust = 0.5)) + geom_line(aes(y=0),color=\"salmon\",linetype = 2,size =1) + ylab('THD') + xlim(0,2)\n```",
    "created" : 1527257425217.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3186337753",
    "id" : "1CA0C6F0",
    "lastKnownWriteTime" : 1527608455,
    "last_content_update" : -2147483648,
    "path" : "~/Downloads/WI4231 Mathematical Data Science/Merged Data/Visualisations of daily THD with filter On Off.Rmd",
    "project_path" : "Visualisations of daily THD with filter On Off.Rmd",
    "properties" : {
        "chunk_output_type" : "inline"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}